
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>添加一个服务类 · 简明 ASP.NET Core 手册</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Nate Barbettini">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="use-dependency-injection.html" />
    
    
    <link rel="prev" href="create-view.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../your-first-application/">
            
                <a href="../your-first-application/">
            
                    
                    你的第一个程序
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../your-first-application/get-the-sdk.html">
            
                <a href="../your-first-application/get-the-sdk.html">
            
                    
                    获取 SDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../your-first-application/hello-world-in-csharp.html">
            
                <a href="../your-first-application/hello-world-in-csharp.html">
            
                    
                    C# 版的 Hello World
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../your-first-application/create-aspnetcore-project.html">
            
                <a href="../your-first-application/create-aspnetcore-project.html">
            
                    
                    创建一个 ASP.NET Core 项目
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    MVC 基础
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="create-controller.html">
            
                <a href="create-controller.html">
            
                    
                    创建控制器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="create-models.html">
            
                <a href="create-models.html">
            
                    
                    创建模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="create-view.html">
            
                <a href="create-view.html">
            
                    
                    创建视图
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.4" data-path="add-service-class.html">
            
                <a href="add-service-class.html">
            
                    
                    添加一个服务类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="use-dependency-injection.html">
            
                <a href="use-dependency-injection.html">
            
                    
                    运用依赖注入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="finish-controller.html">
            
                <a href="finish-controller.html">
            
                    
                    完成控制器
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../add-external-packages/">
            
                <a href="../add-external-packages/">
            
                    
                    添加外来软件包
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../use-a-database/">
            
                <a href="../use-a-database/">
            
                    
                    运用数据库
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../use-a-database/connect-to-a-database.html">
            
                <a href="../use-a-database/connect-to-a-database.html">
            
                    
                    连接数据库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../use-a-database/update-context.html">
            
                <a href="../use-a-database/update-context.html">
            
                    
                    修改数据库上下文
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../use-a-database/create-migration.html">
            
                <a href="../use-a-database/create-migration.html">
            
                    
                    创建变更
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../use-a-database/create-service-class.html">
            
                <a href="../use-a-database/create-service-class.html">
            
                    
                    创建服务类
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../add-more-features/">
            
                <a href="../add-more-features/">
            
                    
                    添加新特性
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../add-more-features/add-todo-items.html">
            
                <a href="../add-more-features/add-todo-items.html">
            
                    
                    添加 待办事项 条目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../add-more-features/complete-with-checkbox.html">
            
                <a href="../add-more-features/complete-with-checkbox.html">
            
                    
                    使用复选框标记条目完成
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../security-and-identity/">
            
                <a href="../security-and-identity/">
            
                    
                    安全和身份
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../security-and-identity/add-facebook-login.html">
            
                <a href="../security-and-identity/add-facebook-login.html">
            
                    
                    添加 Facebook 登录功能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../security-and-identity/require-authentication.html">
            
                <a href="../security-and-identity/require-authentication.html">
            
                    
                    提示认证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../security-and-identity/using-identity-in-the-application.html">
            
                <a href="../security-and-identity/using-identity-in-the-application.html">
            
                    
                    在程序中使用身份
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../security-and-identity/authorization-with-roles.html">
            
                <a href="../security-and-identity/authorization-with-roles.html">
            
                    
                    按角色进行授权
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../automated-testing/">
            
                <a href="../automated-testing/">
            
                    
                    自动化测试
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../automated-testing/unit-testing.html">
            
                <a href="../automated-testing/unit-testing.html">
            
                    
                    单元测试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../automated-testing/integration-testing.html">
            
                <a href="../automated-testing/integration-testing.html">
            
                    
                    集成测试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../deploy-the-application/">
            
                <a href="../deploy-the-application/">
            
                    
                    部署程序
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../deploy-the-application/deploy-to-azure.html">
            
                <a href="../deploy-the-application/deploy-to-azure.html">
            
                    
                    部署到 Azure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../deploy-the-application/deploy-with-docker.html">
            
                <a href="../deploy-the-application/deploy-with-docker.html">
            
                    
                    使用 Docker 进行部署
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../conclusion/">
            
                <a href="../conclusion/">
            
                    
                    结束语
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >添加一个服务类</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x7C7B;"><a name="&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x7C7B;" class="plugin-anchor" href="#&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x7C7B;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x7C7B;</h2>
<p>&#x4F60;&#x5DF2;&#x7ECF;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x6A21;&#x578B;&#x3001;&#x4E00;&#x4E2A;&#x89C6;&#x56FE;&#x3001;&#x4E00;&#x4E2A;&#x63A7;&#x5236;&#x5668;&#x3002;&#x5728;&#x4F60;&#x628A;&#x6A21;&#x578B;&#x548C;&#x89C6;&#x56FE;&#x5E94;&#x7528;&#x4E8E;&#x63A7;&#x5236;&#x5668;&#x4E2D;&#x4E4B;&#x524D;&#xFF0C;&#x5E94;&#x8BE5;&#x5148;&#x5199;&#x70B9;&#x4EE3;&#x7801;&#xFF0C;&#x628A;&#x7528;&#x6237;&#x7684;&#x5F85;&#x529E;&#x4E8B;&#x9879;&#x6761;&#x76EE;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x91CC;&#x53D6;&#x51FA;&#x6765;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x63A7;&#x5236;&#x5668;&#x91CC;&#x76F4;&#x63A5;&#x5199;&#x64CD;&#x4F5C;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x4F46;&#x662F;&#x66F4;&#x597D;&#x7684;&#x4E60;&#x60EF;&#x662F;&#xFF1A;&#x628A;&#x6240;&#x6709;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4EE3;&#x7801;&#x90FD;&#x7F6E;&#x4E8E;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#xFF0C;&#x79F0;&#x4E3A; <strong>&#x670D;&#x52A1;(service)</strong> &#x7684;&#x7C7B;&#x91CC;&#x9762;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x80FD;&#x5C3D;&#x91CF;&#x5730;&#x4FDD;&#x6301;&#x63A7;&#x5236;&#x5668;&#x7B80;&#x5355;&#xFF0C;&#x8FD8;&#x4FBF;&#x4E8E;&#x4EE5;&#x540E;&#x6D4B;&#x8BD5;&#x548C;&#x4FEE;&#x6539;&#x6570;&#x636E;&#x5E93;&#x76F8;&#x5173;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x628A;&#x7A0B;&#x5E8F;&#x6309;&#x7167;&#x903B;&#x8F91;&#xFF0C;&#x5206;&#x51FA;&#x4E00;&#x4E2A;&#x5C42;&#x5904;&#x7406;&#x6570;&#x636E;&#x5E93;&#x8BBF;&#x95EE;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5C42;&#x5904;&#x7406;&#x89C6;&#x56FE;&#x5448;&#x73B0;&#xFF0C;&#x8FD9;&#x79CD;&#x7ED3;&#x6784;&#x6709;&#x65F6;&#x5019;&#x88AB;&#x79F0;&#x4E3A;&#x5206;&#x5C42;&#x7684;&#x3001;3&#x5C42;&#x7684;&#x3001;&#x6216;&#x8005;n&#x5C42;&#x7684;&#x67B6;&#x6784;&#x3002;</p>
</blockquote>
<p>.NET &#x548C; C# &#x4E2D;&#x6709;&#x4E2A; <strong>&#x63A5;&#x53E3;(interfaces)</strong> &#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#x3001;&#x5C5E;&#x6027;&#x7684;&#x5B9A;&#x4E49;&#x4E0E;&#x4E8B;&#x5B9E;&#x4E0A;&#x5305;&#x542B;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x3001;&#x5C5E;&#x6027;&#x6E90;&#x7801;&#x7684;&#x5B9E;&#x73B0;&#x7C7B;&#x533A;&#x5206;&#x5F00;&#x6765;&#x3002;&#x63A5;&#x53E3;&#x4FBF;&#x4E8E;&#x4F60;&#x7684;&#x7C7B;&#x4E4B;&#x95F4;&#x89E3;&#x8026;&#xFF0C;&#x4E5F;&#x4FBF;&#x4E8E;&#x5176;&#x6D4B;&#x8BD5;&#xFF0C;&#x4F60;&#x5C06;&#x89C1;&#x8BF8;&#x4E8E;&#x540E;&#x7EED;&#x7AE0;&#x8282;&#xFF08;<em>&#x81EA;&#x52A8;&#x5316;&#x6D4B;&#x8BD5;</em> &#x90A3;&#x7AE0;&#xFF09;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4EE3;&#x8868;&#x670D;&#x52A1;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x8BE5;&#x670D;&#x52A1;&#x7528;&#x6765;&#x4E0E;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x5F85;&#x529E;&#x4E8B;&#x9879;&#x6761;&#x76EE;&#x4EA4;&#x4E92;&#x3002;&#x4E60;&#x60EF;&#x4E0A;&#xFF0C;&#x63A5;&#x53E3;&#x4EE5;&#x5B57;&#x6BCD;&#x201C;I&#x201D;&#x5F00;&#x5934;&#xFF0C;&#x5728; Services &#x76EE;&#x5F55;&#x4E0B;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF1A;</p>
<p><strong><code>Services/ITodoItemService.cs</code></strong></p>
<pre><code class="lang-csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> AspNetCoreTodo.Models;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">AspNetCoreTodo.Services</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">ITodoItemService</span>
    {
        Task&lt;IEnumerable&lt;TodoItem&gt;&gt; GetIncompleteItemsAsync();
    }
}
</code></pre>
<p>&#x6CE8;&#x610F;&#x4E00;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x662F; <code>AspNetCoreTodo.Services</code>&#x3002;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x662F;&#x4E00;&#x79CD;&#x7EC4;&#x7EC7; .Net &#x4EE3;&#x7801;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x4E00;&#x822C;&#x4E0E;&#x5B58;&#x653E;&#x8BE5;&#x6587;&#x4EF6;&#x7684;&#x76EE;&#x5F55;&#x540D;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#xFF08;<code>Services</code>&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x662F;<code>AspNetCoreTodo.Services</code>&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#xFF09;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF08;&#x5728;&#x547D;&#x540D;&#x7A7A;&#x95F4;<code>AspNetCoreTodo.Services</code>&#x4E2D;&#xFF09;&#x5F15;&#x7528;&#x4E86; <code>TodoItem</code> &#x7C7B;&#xFF08;&#x5728;&#x547D;&#x540D;&#x7A7A;&#x95F4; <code>AspNetCoreTodo.Models</code>&#x4E2D;&#xFF09;&#xFF0C;&#x5B83;&#x9700;&#x8981;&#x5728;&#x6587;&#x4EF6;&#x9876;&#x90E8;&#x5305;&#x542B;&#x4E00;&#x6761; <code>using</code> &#x8BED;&#x53E5;&#xFF0C;&#x5F15;&#x5165;&#x90A3;&#x4E2A;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x5199;&#x8FD9;&#x4E2A; <code>using</code> &#x8BED;&#x53E5;&#xFF0C;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x8FD9;&#x6837;&#x7684;&#x62A5;&#x9519;&#xFF1A;</p>
<pre><code class="lang-txt">The type or namespace name &apos;TodoItem&apos; could not be found (are you missing a using directive or an assembly reference?)
</code></pre>
<p>&#x56E0;&#x4E3A;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x5305;&#x542B;&#x4EFB;&#x4F55;&#x5B9E;&#x73B0;&#x76F8;&#x5173;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x53EA;&#x6709; <code>GetIncompleteItemsAsync</code> &#x65B9;&#x6CD5;&#x7684;&#x5B9A;&#x4E49;&#xFF08;&#x6216;&#x8005;&#x53EB; <strong>&#x65B9;&#x6CD5;&#x7B7E;&#x540D;(method signature)</strong>&#xFF09;&#x3002;&#x8BE5;&#x65B9;&#x6CD5;&#x4E0D;&#x9700;&#x8981;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x4E14;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A; <code>Task&lt;IEnumerable&lt;TodoItem&gt;&gt;</code>&#x3002;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x5BF9;&#x8FD9;&#x79CD;&#x8BED;&#x6CD5;&#x770B;&#x4E0A;&#x53BB;&#x611F;&#x5230;&#x56F0;&#x60D1;&#xFF0C;&#x5C31;&#x8FD9;&#x4E48;&#x7406;&#x89E3;&#xFF1A;&#x201C;&#x4E00;&#x4E2A; Task &#x91CC;&#x9762;&#x88C5;&#x7740;&#x4E00;&#x4E2A; TodoItem &#x7684;&#x5217;&#x8868;&#x201D;&#x3002;</p>
</blockquote>
<p><code>Task</code> &#x7C7B;&#x578B;&#x7C7B;&#x4F3C;&#x4E8E;&#x4E00;&#x4E2A; future &#x6216;&#x8005; promise<sup><a href="#fn_1" id="reffn_1">1</a></sup>&#xFF0C;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x5B83;&#x7684;&#x539F;&#x56E0;&#x662F;&#xFF0C;&#x8FD9;&#x5C06;&#x662F;&#x4E2A; <strong>&#x5F02;&#x6B65;&#x7684;(asynchronous)</strong> &#x65B9;&#x6CD5;&#x3002;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x53EF;&#x80FD;&#x4E0D;&#x4F1A;&#x5373;&#x65F6;&#x8FD4;&#x56DE;&#x5F85;&#x529E;&#x4E8B;&#x9879;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x9700;&#x8981;&#x5148;&#x67E5;&#x8BE2;&#x6570;&#x636E;&#x5E93;&#x3002;&#xFF08;&#x8BE6;&#x60C5;&#x89C1;&#x540E;&#x7EED;&#x7AE0;&#x8282;&#x3002;&#xFF09;</p>
<p>&#x73B0;&#x5728;&#x63A5;&#x53E3;&#x5DF2;&#x7ECF;&#x5B9A;&#x4E49;&#xFF0C;&#x4F60;&#x53EF;&#x5F00;&#x59CB;&#x521B;&#x5EFA;&#x5177;&#x4F53;&#x7684;&#x670D;&#x52A1;&#x7C7B;&#x4E86;&#x3002;&#x5728;&#x540E;&#x7EED;&#x7684; <em>&#x4F7F;&#x7528;&#x6570;&#x636E;&#x5E93;</em> &#x90A3;&#x7AE0;&#xFF0C;&#x6211;&#x4F1A;&#x6DF1;&#x5165;&#x8BB2;&#x89E3;&#x6709;&#x5173;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x4F46;&#x76EE;&#x524D;&#x4F60;&#x53EF;&#x4EE5;&#x9020;&#x4E2A;&#x5047;&#xFF0C;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x786C;&#x7F16;&#x7801;&#x7684;&#x503C;&#xFF1A;</p>
<p><strong><code>Services/FakeTodoItemService.cs</code></strong></p>
<pre><code class="lang-csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> AspNetCoreTodo.Models;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">AspNetCoreTodo.Services</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FakeTodoItemService</span> : <span class="hljs-title">ITodoItemService</span>
    {
        <span class="hljs-keyword">public</span> Task&lt;IEnumerable&lt;TodoItem&gt;&gt; GetIncompleteItemsAsync()
        {
            <span class="hljs-comment">// &#x8FD4;&#x56DE;&#x4E00;&#x4E2A; TodoItems &#x7684;&#x6570;&#x7EC4;</span>
            IEnumerable&lt;TodoItem&gt; items = <span class="hljs-keyword">new</span>[]
            {
                <span class="hljs-keyword">new</span> TodoItem
                {
                    Title = <span class="hljs-string">&quot;Learn ASP.NET Core&quot;</span>,
                    DueAt = DateTimeOffset.Now.AddDays(<span class="hljs-number">1</span>)
                },
                <span class="hljs-keyword">new</span> TodoItem
                {
                    Title = <span class="hljs-string">&quot;Build awesome apps&quot;</span>,
                    DueAt = DateTimeOffset.Now.AddDays(<span class="hljs-number">2</span>)
                }
            };

            <span class="hljs-keyword">return</span> Task.FromResult(items);
        }
    }
}
</code></pre>
<p><code>FakeTodoItemService</code> &#x5B9E;&#x73B0;&#x4E86; <code>ITodoItemService</code> &#x63A5;&#x53E3;&#xFF0C;&#x4F46;&#x603B;&#x662F;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x5305;&#x542B;&#x4E24;&#x4E2A; <code>TodoItem</code> &#x7684;&#x6570;&#x7EC4;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x5B83;&#x53BB;&#x6D4B;&#x8BD5;&#x63A7;&#x5236;&#x5668;&#x548C;&#x89C6;&#x56FE;&#xFF0C;&#x7136;&#x540E;&#x5728; <em>&#x4F7F;&#x7528;&#x6570;&#x636E;&#x5E93;</em> &#x90A3;&#x7AE0;&#x6DFB;&#x52A0;&#x771F;&#x6B63;&#x7684;&#x4EE3;&#x7801;&#x53BB;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x5E93;&#x3002;</p>
<blockquote id="fn_1">
<sup>1</sup>. &#x8BD1;&#x8005;&#x6CE8;&#xFF1A;&#x4E8C;&#x8005;&#x90FD;&#x662F;&#x5176;&#x5B83;&#x8BED;&#x8A00;&#x4E2D;&#xFF0C;&#x4E0E;&#x5F02;&#x6B65;&#x7F16;&#x7A0B;&#x76F8;&#x5173;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x5B83;&#x4EEC;&#x662F;&#x7528;&#x4E8E;&#x6307;&#x4EE3;&#x67D0;&#x4E2A;&#x5C1A;&#x672A;&#x5C31;&#x7EEA;&#x7684;&#x503C;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x800C;&#x8FD9;&#x4E2A;&#x503C;&#xFF0C;&#x5F80;&#x5F80;&#x662F;&#x67D0;&#x4E2A;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x8981;&#x4E86;&#x89E3;&#x8BE6;&#x7EC6;&#xFF0C;&#x8BF7;&#x53C2;&#x8003; <a href="https://en.wikipedia.org/wiki/Futures_and_promises" target="_blank">https://en.wikipedia.org/wiki/Futures_and_promises</a><a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#x21A9;</a>
</blockquote>
<hr>
<h2 id="add-a-service-class"><a name="add-a-service-class" class="plugin-anchor" href="#add-a-service-class"><i class="fa fa-link" aria-hidden="true"></i></a>Add a service class</h2>
<p>You&apos;ve created a model, a view, and a controller. Before you use the model and view in the controller, you also need to write code that will get the user&apos;s to-do items from a database.</p>
<p>You could write this database code directly in the controller, but it&apos;s a better practice to keep all the database code in a separate class called a <strong>service</strong>. This helps keep the controller as simple as possible, and makes it easier to test and change the database code later.</p>
<blockquote>
<p>Separating your application logic into one layer that handles database access and another layer that handles presenting a view is sometimes called a layered, 3-tier, or n-tier architecture.</p>
</blockquote>
<p>.NET and C# include the concept of <strong>interfaces</strong>, where the definition of an object&apos;s methods and properties is separate from the class that actually contains the code for those methods and properties. Interfaces make it easy to keep your classes decoupled and easy to test, as you&apos;ll see here (and later in the <em>Automated testing</em> chapter).</p>
<p>First, create an interface that will represent the service that can interact with to-do items in the database. By convention, interfaces are prefixed with &quot;I&quot;. Create a new file in the Services directory:</p>
<p><strong><code>Services/ITodoItemService.cs</code></strong></p>
<pre><code class="lang-csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> AspNetCoreTodo.Models;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">AspNetCoreTodo.Services</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">ITodoItemService</span>
    {
        Task&lt;IEnumerable&lt;TodoItem&gt;&gt; GetIncompleteItemsAsync();
    }
}
</code></pre>
<p>Note that the namespace of this file is <code>AspNetCoreTodo.Services</code>. Namespaces are a way to organize .NET code files, and it&apos;s customary for the namespace to follow the directory the file is stored in (<code>AspNetCoreTodo.Services</code> for files in the <code>Services</code> directory, and so on).</p>
<p>Because this file (in the <code>AspNetCoreTodo.Services</code> namespace) references the <code>TodoItem</code> class (in the <code>AspNetCoreTodo.Models</code> namespace), it needs to include a <code>using</code> statement at the top of the file to import that namespace. Without the <code>using</code> statement, you&apos;ll see an error like:</p>
<pre><code>The type or namespace name &apos;TodoItem&apos; could not be found (are you missing a using directive or an assembly reference?)
</code></pre><p>Since this is an interface, there isn&apos;t any actual code here, just the definition (or <strong>method signature</strong>) of the <code>GetIncompleteItemsAsync</code> method. This method requires no parameters and returns a <code>Task&lt;IEnumerable&lt;TodoItem&gt;&gt;</code>.</p>
<blockquote>
<p>If this syntax looks confusing, think: &quot;a Task that contains a list of TodoItems&quot;.</p>
</blockquote>
<p>The <code>Task</code> type is similar to a future or a promise, and it&apos;s used here because this method will be <strong>asynchronous</strong>. In other words, the method may not be able to return the list of to-do items right away because it needs to go talk to the database first. (More on this later.)</p>
<p>Now that the interface is defined, you&apos;re ready to create the actual service class. I&apos;ll cover database code in depth in the <em>Use a database</em> chapter, but for now you&apos;ll just fake it and return hard-coded values:</p>
<p><strong><code>Services/FakeTodoItemService.cs</code></strong></p>
<pre><code class="lang-csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> AspNetCoreTodo.Models;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">AspNetCoreTodo.Services</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FakeTodoItemService</span> : <span class="hljs-title">ITodoItemService</span>
    {
        <span class="hljs-keyword">public</span> Task&lt;IEnumerable&lt;TodoItem&gt;&gt; GetIncompleteItemsAsync()
        {
            <span class="hljs-comment">// Return an array of TodoItems</span>
            IEnumerable&lt;TodoItem&gt; items = <span class="hljs-keyword">new</span>[]
            {
                <span class="hljs-keyword">new</span> TodoItem
                {
                    Title = <span class="hljs-string">&quot;Learn ASP.NET Core&quot;</span>,
                    DueAt = DateTimeOffset.Now.AddDays(<span class="hljs-number">1</span>)
                },
                <span class="hljs-keyword">new</span> TodoItem
                {
                    Title = <span class="hljs-string">&quot;Build awesome apps&quot;</span>,
                    DueAt = DateTimeOffset.Now.AddDays(<span class="hljs-number">2</span>)
                }
            };

            <span class="hljs-keyword">return</span> Task.FromResult(items);
        }
    }
}
</code></pre>
<p>This <code>FakeTodoItemService</code> implements the <code>ITodoItemService</code> interface but always returns the same array of two <code>TodoItem</code>s. You&apos;ll use this to test the controller and view, and then add real database code in <em>Use a database</em>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="create-view.html" class="navigation navigation-prev " aria-label="Previous page: 创建视图">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="use-dependency-injection.html" class="navigation navigation-next " aria-label="Next page: 运用依赖注入">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"添加一个服务类","level":"1.3.4","depth":2,"next":{"title":"运用依赖注入","level":"1.3.5","depth":2,"path":"chapters/mvc-basics/use-dependency-injection.md","ref":"chapters/mvc-basics/use-dependency-injection.md","articles":[]},"previous":{"title":"创建视图","level":"1.3.3","depth":2,"path":"chapters/mvc-basics/create-view.md","ref":"chapters/mvc-basics/create-view.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters-small","disqus","splitter","anchors","copy-code-button"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"disqus":{"useIdentifier":false,"shortName":"little-aspnetcore-book-cn"},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"expandable-chapters-small":{},"copy-code-button":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","author":"Nate Barbettini","pdf":{"pageNumbers":true,"fontSize":13,"fontFamily":"Microsoft YaHei","paperSize":"b5","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":12,"left":12,"top":12,"bottom":12,"comment_from_windsting":"these margin settings not working."}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"简明 ASP.NET Core 手册","language":"zh-hans","gitbook":"*","description":"一个关于“使用 ASP.NET Core 框架的构建 web 应用程序”的入门简介。"},"file":{"path":"chapters/mvc-basics/add-service-class.md","mtime":"2017-11-28T03:13:19.915Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-11-28T08:45:05.947Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

